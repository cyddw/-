## 多变量的因果关系发现
### 核心问题：如何从多变量问题中找到变量间的因果关系
### 解决方法:  
**1.** 模型基本假设：噪声呈联合独立高斯分布，且函数都是非线性  
<img width="575" alt="屏幕截图 2024-10-12 162701" src="https://github.com/user-attachments/assets/f43adf0f-8425-45ac-a1b6-a788ff507fd2">  
**2.** 引入[KL散度](https://zhuanlan.zhihu.com/p/100676922)，[简单来讲，KL散度就是利用信息论的熵的概念来量化估计模型和实际模之间的差距，KL散度越小，估计模型丢失的信息越少]来计算实验分布和X->Y函数空间以及Y->X函数空间的距离，对于多变量，则有下面的方法：  
<img width="587" alt="image" src="https://github.com/user-attachments/assets/282c64a6-37b6-4ec5-8680-b2167afe9bd0">  
上式中residuals是残差，即观察值与估计值（拟合值）之间的差。用一句话说明就是：遍历每一种可能的因果关系，基于每种因果关系，拟合出分布函数，再计算拟合出的分布与真实分布之间的距离，最后选择那个与真实分布距离最小的分布函数基于的因果关系。  
## 基于不变性的因果预测
### 核心问题：假设我们现在有一个因果系统，不知道因果关系，但在不同环境下观测到了一系列数据，左边蓝色数据是在环境1中观测到的，右边红色数据是在环境2中观测到的。环境和环境之间的区别在于做了不同的干预。现在我们想要知道Y的因是哪些。
### 解决方法：
**不变性原理**  
如果Y的结构方程不变，那么无论如何进行干预，只要不干预Y，P(Y|PA<sub>Y</sub>)保持不变。这个很好理解，Y的值由Y的因和噪音决定，那么如果确定了因的值，Y的分布也是确定的，且与图中其他变量是无关的。  
<img width="692" alt="image" src="https://github.com/user-attachments/assets/08a571a6-5b89-4b5c-b994-a05753ef8392">  
基于上述不变性原理，可以寻找Y的因：穷举S，然后检测这个S是否会使得P(Y|S)在不同环境下一致。如果某个S使得P(Y|S)在不同环境下一致，那么S有可能就是PA<sub>Y</sub>。当出现多个集合符合要求，即满足不变性原理时，取交集，即为Y的因。
### 疑问：为什么不直接对S进行干预，如果P(Y|S)变化，S不就是Y的因吗？
<font color=#DC143C>事实上，如果P(Y|S)变化，S可能是Y的间接因，若认为S是直接因会导致最后构建出的因果图和实际因果图差距很大</font>
+ j
